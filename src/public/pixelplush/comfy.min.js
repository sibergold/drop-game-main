"use strict";var V=(a,r,s)=>{if(!r.has(a))throw TypeError("Cannot "+s)};var n=(a,r,s)=>(V(a,r,"read from private field"),s?s.call(a):r.get(a)),f=(a,r,s)=>{if(r.has(a))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(a):r.set(a,s)},M=(a,r,s,i)=>(V(a,r,"write to private field"),i?i.call(a,s):r.set(a,s),s);var N=(a,r,s)=>(V(a,r,"access private method"),s);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function aa(a){return!a||typeof a!="string"||!a.includes("\\")?a:a.replace(/\\(.)/g,(r,s)=>{switch(s){case"\\":return"\\";case":":return";";case"s":return" ";case"r":return"\r";case"n":return`
`;default:return s}})}function $a(a){const r=a.indexOf("="),s=a.substring(0,r),i=a.substring(r+1);return{key:s,value:i}}function ta(a){const r={raw:a,tags:{},source:null,command:null,parameters:null};let s=0;if(a[0]==="@"){s=a.indexOf(" ");const m=a.substring(1,s).split(";");for(const l of m){const{key:P,value:T}=$a(l);r.tags[P]=aa(T)}}a[s]===" "&&s++;const i=a.indexOf(":",s);if(i>=0&&i<a.indexOf(" ",s)){const S=a.indexOf(" ",i);r.source=a.substring(i+1,S),s=S+1}const t=a.indexOf(" :",s);r.command=a.substring(s,t>=0?t:void 0).trim();const e=a.indexOf(":",s);return e>=0&&(r.parameters=a.slice(e+1)),r}const Fa=globalThis.WebSocket||require("ws");function Ta(a,r){return new Fa(a,r)}var d=(a=>(a.None="none",a.Ping="Ping",a.Pong="Pong",a.Connect="connect",a.Reconnect="reconnect",a.Error="error",a.Warning="Warning",a.ChatMode="chatmode",a.ClearChat="ClearChat",a.RoomState="roomstate",a.GlobalUserState="globaluserstate",a.UserState="userstate",a.Notice="notice",a.Join="join",a.Leave="leave",a.Command="command",a.Chat="message",a.Reply="reply",a.Whisper="whisper",a.Announcement="announcement",a.Cheer="Cheer",a.Subscribe="sub",a.Resubscribe="resub",a.SubGift="subgift",a.MysterySubGift="submysterygift",a.SubGiftContinue="subgiftcontinue",a.Raid="raid",a.Unraid="unraid",a.Timeout="Timeout",a.Ban="Ban",a.MessageDeleted="MessageDeleted",a.ViewerMilestone="ViewerMilestone",a.All="all",a))(d||{}),ra=(a=>(a.AggressiveContent="aggressive",a.IdentityBasedHate="identity-hate",a.ProfaneContent="profane",a.SexualContent="sexual",a))(ra||{});const I={"":"Normal",admin:"Admin",global_mod:"Global Mod",staff:"Staff",mod:"Moderator"};function U(a){if(!a)return;const r=a.indexOf("!");return r!==-1?a.slice(0,r):void 0}function p(a){if(!a)return;const r=a.split(","),s={};for(const i of r){const t=i.indexOf("/");s[i.slice(0,t)]=i.slice(t+1)}return s}function x(a){if(!a)return;const r=a.split(","),s={};for(const i of r){const t=i.indexOf(":"),e=i.indexOf("."),S=i.slice(t+1,e),m=parseInt(i.slice(e+1));switch(S){case"A":s.aggressive=Math.max(s.aggressive||0,m);break;case"I":s["identity-hate"]=Math.max(s["identity-hate"]||0,m);break;case"P":s.profane=Math.max(s.profane||0,m);break;case"S":s.sexual=Math.max(s.sexual||0,m);break}}return s}function Va(a,r){var X,Y,Z;const s=(X=a.parameters)==null?void 0:X.startsWith("ACTION"),i=s?(Z=(Y=a.parameters)==null?void 0:Y.match(/^\u0001ACTION ([^\u0001]+)\u0001$/))==null?void 0:Z[1]:a.parameters,t=a.tags,e=t.id,S=t["room-id"],m=t["user-id"],l=U(a.source),P=t["display-name"]||t.login||l,T=I[t["user-type"]],Ia=t["badge-info"]?p(t["badge-info"]):void 0,C=t.badges?p(t.badges):void 0,ya=t.color||void 0,Ca=t.emotes,q=t.flags,Sa=void 0,Ma=l===r,Na=t.mod==="1",Pa=t.subscriber==="1",Ra=t.turbo==="1",va=C?!!C.vip:!1,Ea=C?!!C.premium:!1,Oa=C?!!C.partner:!1,ka=C?!!C["game-developer"]:!1,Ua=C?!!C.founder:!1,Ga=parseInt(t["tmi-sent-ts"]),_=t["emote-only"]==="1",wa=t["msg-id"]==="highlighted-message",Ba=t["msg-id"]==="skip-subs-mode-message",K=t["custom-reward-id"]||null,Aa=t["first-msg"]==="1",Da=t["returning-chatter"]==="1",Q={channel:r,channelId:S,displayName:P,username:l,userId:m,userType:T,id:e,messageType:s?"action":"chat",messageEmotes:Ca,messageFlags:q,contentFlags:Sa,isEmoteOnly:_,userColor:ya,userBadgeInfo:Ia,userBadges:C,customRewardId:K,flags:{broadcaster:Ma,mod:Na,founder:Ua,subscriber:Pa,vip:va,partner:Oa,gameDeveloper:ka,turbo:Ra,prime:Ea,highlighted:wa,skipSubsMode:Ba,customReward:!!K,emoteOnly:_,firstMessage:Aa,returningChatter:Da},timestamp:Ga,extra:{...t,flags:q||null}};if(t.bits)return{type:"Cheer",data:{...Q,message:a.parameters,bits:parseInt(t.bits)}};{const k=i==null?void 0:i.startsWith("!"),z=k?i.split(/ (.*)/):null,La=k?z[0].substring(1).toLowerCase():null,Wa=k?z[1]||"":null;return{type:k?"command":"message",data:{...Q,message:k?Wa:i,command:La}}}}function sa(a){var r,s,i,t,e,S;try{if(a.command){const m=a.command.split(" "),l=m.length>1?m[1].substring(1):void 0;switch(m[0]){case"PING":return{type:"Ping"};case"PONG":return{type:"Pong"};case"CAP":return null;case"JOIN":return{type:"join",data:{channel:l,username:U(a.source)}};case"PART":return{type:"leave",data:{channel:l,username:U(a.source)}};case"ROOMSTATE":return{type:"roomstate",data:{...a.tags["broadcaster-lang"]&&{broadcasterLanguage:a.tags["broadcaster-lang"]},...a.tags["emote-only"]&&{emoteOnly:a.tags["emote-only"]!=="0"},...a.tags["followers-only"]&&{followersOnly:a.tags["followers-only"]!=="-1"},...a.tags["subs-only"]&&{subscribersOnly:a.tags["subs-only"]!=="0"},...a.tags.r9k&&{r9k:a.tags.r9k!=="0"},...a.tags.rituals&&{rituals:a.tags.rituals!=="0"},...a.tags.slow&&{slow:a.tags.slow!=="0"},channel:l,channelId:a.tags["room-id"]}};case"GLOBALUSERSTATE":return{type:"globaluserstate",data:{displayName:a.tags["display-name"],userId:a.tags["user-id"],userType:I[a.tags["user-type"]],color:a.tags.color,badges:a.tags.badges,badgeInfo:a.tags["badge-info"],emoteSets:a.tags["emote-sets"],extra:a.tags}};case"USERSTATE":return{type:"userstate",data:{channel:l,displayName:a.tags["display-name"],userId:a.tags["user-id"],userType:I[a.tags["user-type"]],color:a.tags.color,badgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,badges:a.tags.badges?p(a.tags.badges):void 0,emoteSets:a.tags["emote-sets"],...a.tags.id&&{id:a.tags.id},mod:a.tags.mod==="1",subscriber:a.tags.subscriber==="1",turbo:a.tags.turbo==="1",extra:a.tags}};case"HOSTTARGET":break;case"USERNOTICE":switch(a.tags["msg-id"]){case"announcement":return{type:"announcement",data:{displayName:a.tags["display-name"]||a.tags.login,channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],message:a.parameters,messageType:a.tags["msg-id"],messageEmotes:a.tags.emotes,timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"sub":return{type:"sub",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,months:parseInt(a.tags["msg-param-months"]),multiMonthDuration:parseInt(a.tags["msg-param-multimonth-duration"]),multiMonthTenure:parseInt(a.tags["msg-param-multimonth-tenure"]),shouldShareStreak:a.tags["msg-param-should-share-streak"]==="1",subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],wasGifted:a.tags["msg-param-was-gifted"]==="true",...a.tags["msg-param-goal-contribution-type"]&&{goalContributionType:a.tags["msg-param-goal-contribution-type"]},...a.tags["msg-param-goal-current-contributions"]&&{goalCurrentContributions:parseInt(a.tags["msg-param-goal-current-contributions"])},...a.tags["msg-param-goal-description"]&&{goalDescription:a.tags["msg-param-goal-description"]},...a.tags["msg-param-goal-target-contributions"]&&{goalTargetContributions:parseInt(a.tags["msg-param-goal-target-contributions"])},...a.tags["msg-param-goal-user-contributions"]&&{goalUserContributions:parseInt(a.tags["msg-param-goal-user-contributions"])},channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,userColor:a.tags.color||void 0,message:a.parameters,messageType:a.tags["msg-id"],messageEmotes:a.tags.emotes,messageFlags:a.tags.flags,contentFlags:x(a.tags.flags),timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"resub":return{type:"resub",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,cumulativeMonths:parseInt(a.tags["msg-param-cumulative-months"]),months:parseInt(a.tags["msg-param-months"]),multiMonthDuration:parseInt(a.tags["msg-param-multimonth-duration"]),multiMonthTenure:parseInt(a.tags["msg-param-multimonth-tenure"]),...a.tags["msg-param-streak-months"]&&{streakMonths:parseInt(a.tags["msg-param-streak-months"])},shouldShareStreak:a.tags["msg-param-should-share-streak"]==="1",subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],wasGifted:a.tags["msg-param-was-gifted"]==="true",channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,userColor:a.tags.color||void 0,message:a.parameters,messageType:a.tags["msg-id"],messageEmotes:a.tags.emotes,messageFlags:a.tags.flags,contentFlags:x(a.tags.flags),timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"submysterygift":return{type:"submysterygift",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,giftCount:parseInt(a.tags["msg-param-mass-gift-count"]),senderCount:parseInt(a.tags["msg-param-sender-count"]||"0"),subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],...a.tags["msg-param-goal-contribution-type"]&&{goalContributionType:a.tags["msg-param-goal-contribution-type"]},...a.tags["msg-param-goal-current-contributions"]&&{goalCurrentContributions:parseInt(a.tags["msg-param-goal-current-contributions"])},...a.tags["msg-param-goal-description"]&&{goalDescription:a.tags["msg-param-goal-description"]},...a.tags["msg-param-goal-target-contributions"]&&{goalTargetContributions:parseInt(a.tags["msg-param-goal-target-contributions"])},...a.tags["msg-param-goal-user-contributions"]&&{goalUserContributions:parseInt(a.tags["msg-param-goal-user-contributions"])},channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"subgift":return{type:"subgift",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,recipientDisplayName:a.tags["msg-param-recipient-display-name"],recipientId:a.tags["msg-param-recipient-id"],recipientUsername:a.tags["msg-param-recipient-user-name"],months:parseInt(a.tags["msg-param-months"]),giftMonths:parseInt(a.tags["msg-param-gift-months"]),senderCount:parseInt(a.tags["msg-param-sender-count"]||"0"),subPlan:a.tags["msg-param-sub-plan"],subPlanName:a.tags["msg-param-sub-plan-name"],...a.tags["msg-param-goal-contribution-type"]&&{goalContributionType:a.tags["msg-param-goal-contribution-type"]},...a.tags["msg-param-goal-current-contributions"]&&{goalCurrentContributions:parseInt(a.tags["msg-param-goal-current-contributions"])},...a.tags["msg-param-goal-description"]&&{goalDescription:a.tags["msg-param-goal-description"]},...a.tags["msg-param-goal-target-contributions"]&&{goalTargetContributions:parseInt(a.tags["msg-param-goal-target-contributions"])},...a.tags["msg-param-goal-user-contributions"]&&{goalUserContributions:parseInt(a.tags["msg-param-goal-user-contributions"])},channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"giftpaidupgrade":return{type:"subgiftcontinue",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,gifterDisplayName:a.tags["msg-param-sender-name"]||a.tags["msg-param-sender-login"],gifterUsername:a.tags["msg-param-sender-login"],channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"raid":return{type:"raid",data:{id:a.tags.id,profileImageURL:a.tags["msg-param-profileImageURL"],displayName:a.tags["msg-param-displayName"]||a.tags["display-name"]||a.tags["msg-param-login"]||a.tags.login,viewers:parseInt(a.tags["msg-param-viewerCount"]),channel:l,channelId:a.tags["room-id"],username:a.tags["msg-param-login"]||a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"unraid":return console.log(a),{type:"unraid",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,channel:a.tags.login,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,userColor:a.tags.color||void 0,messageType:a.tags["msg-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"viewermilestone":return console.log(a),{type:"ViewerMilestone",data:{id:a.tags.id,displayName:a.tags["display-name"]||a.tags.login,channel:l,channelId:a.tags["room-id"],username:a.tags.login,userId:a.tags["user-id"],userType:I[a.tags["user-type"]],messageType:a.tags["msg-id"],category:a.tags["msg-param-category"],milestoneId:a.tags["msg-param-id"],milestoneValue:parseInt(a.tags["msg-param-value"]),timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};default:console.log("TODO IMPLEMENT COMMAND",a);break}break;case"WHISPER":return{type:"whisper",data:{displayName:a.tags["display-name"]||a.tags.login||U(a.source),username:U(a.source),userId:a.tags["user-id"],userType:I[a.tags["user-type"]],userColor:a.tags.color||void 0,userBadgeInfo:a.tags["badge-info"]?p(a.tags["badge-info"]):void 0,userBadges:a.tags.badges?p(a.tags.badges):void 0,messageEmotes:a.tags.emotes,turbo:a.tags.turbo==="1",threadId:a.tags["thread-id"],messageId:a.tags["message-id"],message:a.parameters,messageType:"whisper",extra:a.tags}};case"NOTICE":return(r=a.parameters)!=null&&r.includes("Login unsuccessful")||(s=a.parameters)!=null&&s.includes("Login authentication failed")||(i=a.parameters)!=null&&i.includes("Error logging in")||(t=a.parameters)!=null&&t.includes("Improperly formatted auth")||(e=a.parameters)!=null&&e.includes("Invalid NICK")||(S=a.parameters)!=null&&S.includes("Invalid CAP REQ")?{type:"error",data:{channel:l,message:a.parameters}}:{type:"notice",data:{channel:l,msgId:a.tags["msg-id"],message:a.parameters}};case"CLEARCHAT":return a.tags["target-user-id"]?a.tags["ban-duration"]?{type:"Timeout",data:{channel:l,channelId:a.tags["room-id"],duration:parseInt(a.tags["ban-duration"]),username:a.parameters,userId:a.tags["target-user-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}}:{type:"Ban",data:{channel:l,channelId:a.tags["room-id"],username:a.parameters,userId:a.tags["target-user-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}}:{type:"ClearChat",data:{channel:l,channelId:a.tags["room-id"],timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"CLEARMSG":return{type:"MessageDeleted",data:{channel:l,channelId:a.tags["room-id"],displayName:a.tags["display-name"]||a.tags.login,username:a.tags.login,id:a.tags["target-msg-id"],message:a.parameters,timestamp:parseInt(a.tags["tmi-sent-ts"]),extra:a.tags}};case"PRIVMSG":return Va(a,l);case"RECONNECT":console.info("The Twitch IRC server is about to terminate the connection for maintenance.");break;default:{const P=parseInt(m[0]);if(P>=400)return console.debug(`Error IRC command: ${P}`,a),null;switch(P){case 1:return null;case 2:case 3:case 4:case 353:case 366:case 372:case 375:return null;case 376:return{type:"connect",data:{username:m[1]}};default:return console.debug("Unsupported numeric command",P),null}}break}}else console.debug("Unprocessed IRC message:",a.raw)}catch(m){return console.error(m),{type:"Warning",data:m}}return console.log(a),null}function na(a){a.send("CAP REQ :twitch.tv/tags twitch.tv/commands")}function ea(a,r,s){const i=s?r:`justinfan${Math.floor(Math.random()*99998999+1e3)}`,t=s||"INSTAFLUFF";a.send(`PASS ${t}`),a.send(`NICK ${i}`)}function j(a,r){if(Array.isArray(r)){const s=r.map(i=>`#${i}`).join(",");a.send(`JOIN ${s}`)}else a.send(`JOIN #${r}`)}function ia(a,r){a.send(`PART #${r}`)}function oa(a){a.send("PING")}function ua(a){a.send("PONG")}function da(a,r,s){a.send(`PRIVMSG #${r} :${s}`)}function la(a,r,s,i){a.send(`@reply-parent-msg-id=${s} PRIVMSG #${r} :${i}`)}var u,R,G,v,E,O,w,J,h,y,A,pa,D,ma,L,fa,W,ca,$,ba,F,ha,B,H;class ga{constructor(r,s,i,t){f(this,w);f(this,h);f(this,A);f(this,D);f(this,L);f(this,W);f(this,$);f(this,F);f(this,B);f(this,u,void 0);f(this,R,void 0);f(this,G,void 0);f(this,v,void 0);f(this,E,void 0);f(this,O,void 0);M(this,E,0),M(this,O,-1),this.reconnects=0,this.chatModes={},this.handlers={},M(this,R,r),M(this,G,s),this.debug=!!t,(typeof i=="string"||i instanceof String)&&(i=[i]),this.channels=i||[r],N(this,A,pa).call(this)}get version(){return"2.0.0"}get latency(){return n(this,O)}get ws(){return n(this,u)}on(r,s){this.handlers[r]=s}say(r,s){n(this,u)&&n(this,h,y)&&da(n(this,u),s||n(this,w,J),r)}reply(r,s,i){n(this,u)&&n(this,h,y)&&la(n(this,u),i||n(this,w,J),r,s)}join(r){n(this,u)&&n(this,h,y)&&j(n(this,u),r)}leave(r){n(this,u)&&n(this,h,y)&&ia(n(this,u),r)}deleteMessage(r,s){n(this,u)&&n(this,h,y)}simulateIRCMessage(r){n(this,u)&&n(this,h,y)&&N(this,B,H).call(this,{data:r})}destroy(){n(this,u)&&n(this,u).readyState!==n(this,u).CLOSED&&n(this,u).close()}}u=new WeakMap,R=new WeakMap,G=new WeakMap,v=new WeakMap,E=new WeakMap,O=new WeakMap,w=new WeakSet,J=function(){return this.channels[0]},h=new WeakSet,y=function(){return!!(n(this,u)&&n(this,u).readyState===n(this,u).OPEN)},A=new WeakSet,pa=function(){if(n(this,h,y))return;M(this,u,Ta("wss://irc-ws.chat.twitch.tv:443","irc")),n(this,u).onopen=()=>{N(this,D,ma).call(this)},n(this,u).onmessage=s=>{N(this,B,H).call(this,s)},n(this,u).onerror=s=>{N(this,L,fa).call(this,s)},n(this,u).onclose=s=>{N(this,W,ca).call(this,s)}},D=new WeakSet,ma=function(){n(this,u)&&n(this,h,y)&&(na(n(this,u)),ea(n(this,u),n(this,R),n(this,G)))},L=new WeakSet,fa=function(r){console.error("ERROR",r)},W=new WeakSet,ca=function(r){console.info("CLOSE",r),n(this,v)&&clearInterval(n(this,v))},$=new WeakSet,ba=function(){n(this,u)&&n(this,h,y)&&(M(this,E,Date.now()),oa(n(this,u)))},F=new WeakSet,ha=function(r){if(n(this,u)&&n(this,h,y))switch(r.type){case d.Connect:M(this,R,r.data.username),n(this,v)&&clearInterval(n(this,v)),M(this,v,setInterval(()=>{N(this,$,ba).call(this)},6e4));const s=new URL(n(this,u).url);r.data.address=s.host,r.data.port=s.protocol==="wss:"?443:80,r.data.isFirstConnect=this.reconnects===0,j(n(this,u),this.channels);break;case d.Ping:ua(n(this,u));break;case d.Pong:r.data=r.data||{},M(this,O,r.data.latency=Date.now()-n(this,E));break;case d.RoomState:this.chatModes[r.data.channel]={...this.chatModes[r.data.channel],...r.data},this.handlers[d.ChatMode]&&this.handlers[d.ChatMode](this.chatModes[r.data.channel]);break;case d.Error:n(this,u).close();break;case d.Whisper:r.data.self=r.data.username===n(this,R);break;case d.Chat:r.data.self=r.data.username===n(this,R),this.handlers[d.Reply]&&r.data.extra["reply-parent-msg-id"]&&this.handlers[d.Reply]({...r.data,parentId:r.data.extra["reply-parent-msg-id"],parentUserId:r.data.extra["reply-parent-user-id"],parentUser:r.data.extra["reply-parent-user-login"],parentMessage:r.data.extra["reply-parent-msg-body"],parentDisplayName:r.data.extra["reply-parent-display-name"]||r.data.extra["reply-parent-user-login"]});break}},B=new WeakSet,H=function(r){if(!n(this,u)||!n(this,h,y))return;const s=r.data.trim().split(`\r
`);for(const i of s){const t=sa(ta(i));t&&t.type!==d.None&&(N(this,F,ha).call(this,t),this.handlers[t.type]&&this.handlers[t.type](t.data),this.handlers[d.All]&&this.handlers[d.All]({event:t.type,...t.data}))}};let o;function c(a){if(a){const r=a.split("/"),s={};for(const i of r){const[t,e]=i.split(":");s[t]=e.split(",")}return s}return null}function b(a){const r={};for(const s in a.extra)a.extra[s]===""?r[s]=null:a.extra[s]==="1"?r[s]=!0:a.extra[s]==="0"?r[s]=!1:r[s]=a.extra[s];return r["badge-info-raw"]=r["badge-info"],r["badge-info"]=a.userBadgeInfo||null,r["badges-raw"]=r.badges,r.badges=a.userBadges||null,r["emotes-raw"]=r.emotes,r.emotes=c(a.messageEmotes),r.username=a.username,r["message-type"]=a.messageType,r}const g={version:()=>"2.0.0",latency:()=>o?o.latency:-1,getInstance:()=>o,onConnected:(a,r,s)=>{o&&o.debug&&console.debug("onConnected default handler")},onReconnect:a=>{o&&o.debug&&console.debug("onReconnect default handler")},onError:a=>{console.error("Error:",a)},onCommand:(a,r,s,i,t)=>{o&&o.debug&&console.debug("onCommand default handler")},onChat:(a,r,s,i,t)=>{o&&o.debug&&console.debug("onChat default handler")},onCheer:(a,r,s,i,t)=>{o&&o.debug&&console.debug("onCheer default handler")},onWhisper:(a,r,s,i,t)=>{o&&o.debug&&console.debug("onWhisper default handler")},onSub:(a,r,s,i)=>{o&&o.debug&&console.debug("onSub default handler")},onResub:(a,r,s,i,t,e)=>{o&&o.debug&&console.debug("onResub default handler")},onSubGift:(a,r,s,i,t,e)=>{o&&o.debug&&console.debug("onSubGift default handler")},onSubMysteryGift:(a,r,s,i,t)=>{o&&o.debug&&console.debug("onSubMysteryGift default handler")},onGiftSubContinue:(a,r,s)=>{o&&o.debug&&console.debug("onGiftSubContinue default handler")},onTimeout:(a,r,s)=>{o&&o.debug&&console.debug("onTimeout default handler")},onBan:(a,r)=>{o&&o.debug&&console.debug("onBan default handler")},onMessageDeleted:(a,r)=>{o&&o.debug&&console.debug("onMessageDeleted default handler")},onRaid:(a,r,s)=>{o&&o.debug&&console.debug("onRaid default handler")},onUnraid:(a,r)=>{o&&o.debug&&console.debug("onUnraid default handler")},simulateIRCMessage:a=>{o&&o.simulateIRCMessage(a)},Init:(a,r,s,i)=>{o=new ga(a,r,s,i),o.on(d.Connect,t=>{g.onConnected(t.address,t.port,t.isFirstConnect)}),o.on(d.Reconnect,t=>{console.log("RECONNECT"),g.onReconnect(t.reconnectCount)}),o.on(d.Error,t=>{g.onError(t)}),o.on(d.Command,t=>{var e;g.onCommand(t.displayName||t.username,t.command,t.message,t.flags,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Chat,t=>{var e;g.onChat(t.displayName||t.username,t.message,t.flags,t.self,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Whisper,t=>{var e;g.onWhisper(t.displayName||t.username,t.message,t.flags,t.self,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,channel:t.username,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Cheer,t=>{var e;g.onCheer(t.displayName||t.username,t.message,t.bits,t.flags,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Subscribe,t=>{var e;g.onSub(t.displayName||t.username,t.message,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Resubscribe,t=>{var e;g.onResub(t.displayName||t.username,t.message,t.streakMonths||0,t.cumulativeMonths,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.SubGift,t=>{var e;g.onSubGift(t.displayName||t.username,t.streakMonths||0,t.recipientDisplayName,t.senderCount,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.MysterySubGift,t=>{var e;g.onSubMysteryGift(t.displayName||t.username,t.giftCount,t.senderCount,{prime:t.subPlan==="Prime",plan:t.subPlan,planName:t.subPlanName||null},{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes),userMassGiftCount:t.giftCount})}),o.on(d.SubGiftContinue,t=>{var e;g.onGiftSubContinue(t.displayName||t.username,t.gifterDisplayName,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Timeout,t=>{var e;g.onTimeout(t.displayName||t.username,t.duration,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes),timedOutUserId:t.userId})}),o.on(d.Ban,t=>{var e;g.onBan(t.displayName||t.username,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes),bannedUserId:t.userId})}),o.on(d.MessageDeleted,t=>{var e;g.onMessageDeleted(t.id,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Raid,t=>{var e;g.onRaid(t.displayName||t.username,t.viewers,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})}),o.on(d.Unraid,t=>{var e;g.onUnraid(t.channel,{...t,userState:b(t),extra:null,flags:(e=t.extra)==null?void 0:e.flags,roomId:t.channelId,messageEmotes:c(t.messageEmotes)})})}};typeof module<"u"&&module.exports&&(module.exports=g);typeof window<"u"&&(window.ComfyJS?window.ComfyJSv2=g:window.ComfyJS=g);exports.TwitchEventType=d;exports.TwitchEvents=ga;exports.TwitchMessageFlag=ra;exports.authenticate=ea;exports.joinChannel=j;exports.leaveChannel=ia;exports.parseMessage=ta;exports.ping=oa;exports.pong=ua;exports.processMessage=sa;exports.replyChat=la;exports.requestCapabilities=na;exports.sendChat=da;exports.unescapeIRC=aa;
//# sourceMappingURL=comfy.min.js.map
