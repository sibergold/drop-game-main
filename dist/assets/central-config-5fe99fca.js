const c={CLIENT_ID:"01JZWNP6AVSWRZSN7X648B1AQ2",OAUTH_SETTINGS:{response_type:"code",scope:"chat:read chat:write user:read channel:read",authorize_url:"https://id.kick.com/oauth/authorize",token_url:"https://id.kick.com/oauth/token",api_base:"https://kick.com/api/v2",proxy_url:{}.VITE_OAUTH_PROXY_URL||"http://localhost:3001"},DEFAULT_GAME_SETTINGS:{gravity:400,gravity_chute:60,max_velocity:600,wait:60},UI_CONFIG:{theme:{primary_color:"#00ff88",secondary_color:"#9146ff",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},messages:{success:"‚úÖ Authorization successful! Your overlay is ready.",error_no_client_id:"‚ö†Ô∏è Central Client ID not configured. Please contact the developer.",error_auth_failed:"Authorization failed. Please try again.",error_no_chatroom:"No chatroom found for this channel. Make sure you have streaming permissions.",loading:"üîÑ Connecting to Kick...",copied:"‚úÖ Copied!"}},OBS_CONFIG:{default_width:1920,default_height:1080,source_name:"Kick Drop Game",deep_link_protocol:"obs://"}};function h(n){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let t="";for(let e=0;e<n;e++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}async function d(n){const t=new TextEncoder().encode(n);return await crypto.subtle.digest("SHA-256",t)}function p(n){const r=new Uint8Array(n);let t="";for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async function _(){const n=h(128),r=await d(n),t=p(r);return{codeVerifier:n,codeChallenge:t}}function g(){return c.CLIENT_ID!=="YOUR_CENTRAL_CLIENT_ID_HERE"&&c.CLIENT_ID.length>0}async function m(n){if(!g())throw new Error("Central Client ID not configured");const{codeVerifier:r,codeChallenge:t}=await _();sessionStorage.setItem("kick_oauth_code_verifier",r);const e=h(32);sessionStorage.setItem("kick_oauth_state",e);const o=new URLSearchParams({client_id:c.CLIENT_ID,redirect_uri:n,response_type:c.OAUTH_SETTINGS.response_type,scope:c.OAUTH_SETTINGS.scope,code_challenge:t,code_challenge_method:"S256",state:e});return`${c.OAUTH_SETTINGS.authorize_url}?${o.toString()}`}async function k(n,r){console.log("üîÑ Starting token exchange via proxy..."),console.log("Code:",n),console.log("Redirect URI:",r);const t=sessionStorage.getItem("kick_oauth_code_verifier");if(console.log("Code verifier found:",!!t),!t)throw new Error("Code verifier not found in session storage");const e={code:n,redirect_uri:r,code_verifier:t};console.log("Proxy request body:",e),console.log("Proxy endpoint:",`${c.OAUTH_SETTINGS.proxy_url}/oauth/exchange`);const o=await fetch(`${c.OAUTH_SETTINGS.proxy_url}/oauth/exchange`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("Proxy response status:",o.status),!o.ok){const a=await o.json().catch(()=>({error:"Unknown error"}));throw console.error("Proxy token exchange error:",a),new Error(`Token exchange failed: ${o.status} - ${a.error||"Unknown error"}`)}const i=await o.json();return console.log("Token exchange successful via proxy"),sessionStorage.removeItem("kick_oauth_code_verifier"),sessionStorage.removeItem("kick_oauth_state"),i.access_token}async function y(n){try{console.log("üîÑ Fetching user info from Kick API..."),console.log("Access token:",n?"YES":"NO");const r=["https://api.kick.com/public/v1/users",`${c.OAUTH_SETTINGS.api_base}/user`,"https://kick.com/api/v1/user","https://kick.com/api/v2/user/me","https://kick.com/api/v1/user/me"];let t=null;for(const e of r)try{console.log("Trying API endpoint:",e);const o=await fetch(e,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json","Content-Type":"application/json"}});if(console.log(`API response status for ${e}:`,o.status),console.log("API response headers:",Object.fromEntries(o.headers.entries())),!o.ok){const s=await o.text();console.error(`API error response from ${e}:`,s),t=new Error(`API request failed: ${o.status} - ${s}`);continue}const i=o.headers.get("content-type");if(console.log("Response content-type:",i),!i||!i.includes("application/json")){const s=await o.text();console.error(`Non-JSON response from ${e}:`,s.substring(0,200)),t=new Error(`Expected JSON response but got: ${i}. Response: ${s.substring(0,200)}`);continue}const a=await o.json();if(console.log("User data received from",e,":",a),e.includes("api.kick.com/public/v1/users")&&a.data&&Array.isArray(a.data)&&a.data.length>0){const s=a.data[0];console.log("üîÑ Getting chatroom ID for user:",s.name);let u=null;try{const l=await fetch(`https://kick.com/api/v1/channels/${s.name}`,{headers:{Accept:"application/json","Content-Type":"application/json"}});l.ok&&(u=(await l.json()).chatroom?.id,console.log("Chatroom ID found:",u))}catch(l){console.warn("Could not get chatroom ID:",l)}return{id:s.user_id,username:s.name,email:s.email,profile_picture:s.profile_picture,chatroom:{id:u}}}return a}catch(o){console.error(`Error with endpoint ${e}:`,o),t=o instanceof Error?o:new Error(String(o));continue}throw t||new Error("All API endpoints failed")}catch(r){throw console.error("Failed to fetch user info:",r),r}}export{c as C,m as b,k as e,y as f,g as i};
//# sourceMappingURL=central-config-5fe99fca.js.map
